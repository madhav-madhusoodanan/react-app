{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"/home/madhav/Documents/freelancers/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/home/madhav/Documents/freelancers/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _inherits = require(\"/home/madhav/Documents/freelancers/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _createSuper = require(\"/home/madhav/Documents/freelancers/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createSuper\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar events_1 = require(\"events\");\n\nvar xhr2_cookies_1 = require(\"xhr2-cookies\");\n\nvar utils_1 = require(\"@walletconnect/utils\");\n\nvar XHR = utils_1.getFromWindow(\"XMLHttpRequest\") || xhr2_cookies_1.XMLHttpRequest;\n\nvar HTTPConnection = /*#__PURE__*/function (_events_1$EventEmitte) {\n  _inherits(HTTPConnection, _events_1$EventEmitte);\n\n  var _super = _createSuper(HTTPConnection);\n\n  function HTTPConnection(url) {\n    var _this;\n\n    _classCallCheck(this, HTTPConnection);\n\n    _this = _super.call(this);\n    _this.url = url;\n    return _this;\n  }\n\n  _createClass(HTTPConnection, [{\n    key: \"formatError\",\n    value: function formatError(payload, message) {\n      var code = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : -1;\n      return {\n        error: {\n          message: message,\n          code: code\n        },\n        id: payload.id,\n        jsonrpc: payload.jsonrpc\n      };\n    }\n  }, {\n    key: \"send\",\n    value: function send(payload, internal) {\n      var _this2 = this;\n\n      return new Promise(function (resolve) {\n        if (payload.method === \"eth_subscribe\") {\n          var error = _this2.formatError(payload, \"Subscriptions are not supported by this HTTP endpoint\");\n\n          _this2.emit(\"error\", error);\n\n          return resolve(error);\n        }\n\n        var xhr = new XHR();\n        var responded = false;\n\n        var res = function res(err, result) {\n          if (!responded) {\n            xhr.abort();\n            responded = true;\n\n            if (internal) {\n              internal(err, result);\n            } else {\n              var id = payload.id,\n                  jsonrpc = payload.jsonrpc;\n              var response = err ? {\n                id: id,\n                jsonrpc: jsonrpc,\n                error: {\n                  message: err.message,\n                  code: err.code\n                }\n              } : {\n                id: id,\n                jsonrpc: jsonrpc,\n                result: result\n              };\n\n              _this2.emit(\"payload\", response);\n\n              resolve(response);\n            }\n          }\n        };\n\n        xhr.open(\"POST\", _this2.url, true);\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n        xhr.timeout = 60 * 1000;\n        xhr.onerror = res;\n        xhr.ontimeout = res;\n\n        xhr.onreadystatechange = function () {\n          if (xhr.readyState === 4) {\n            try {\n              var response = JSON.parse(xhr.responseText);\n              res(response.error, response.result);\n            } catch (e) {\n              res(e);\n            }\n          }\n        };\n\n        xhr.send(JSON.stringify(payload));\n      });\n    }\n  }]);\n\n  return HTTPConnection;\n}(events_1.EventEmitter);\n\nexports.default = HTTPConnection;","map":null,"metadata":{},"sourceType":"script"}