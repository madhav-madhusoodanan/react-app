{"ast":null,"code":"import _regeneratorRuntime from\"/home/madhav/Documents/freelancers/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/madhav/Documents/freelancers/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/madhav/Documents/freelancers/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useEffect,useState}from\"react\";import{ethers}from\"ethers\";import{toast}from\"react-toastify\";import{useContractLoader,useAppSelector}from\"../hooks\";import{ConnectWalletButton}from\"../components\";import{logoutOfWeb3Modal}from\"../helpers\";import EnterRaffle from\"../components/EnterRaffle\";export default function Whitelist(_ref){var networkProvider=_ref.networkProvider,web3Modal=_ref.web3Modal;var DEBUG=useAppSelector(function(state){return state.debug.debug;});var userAddress=useAppSelector(function(state){return state.user.address;});var _useState=useState(),_useState2=_slicedToArray(_useState,2),injectedProvider=_useState2[0],setInjectedProvider=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),whitelistingEnabled=_useState4[0],setWhitelistingEnabled=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),enteredRaffle=_useState6[0],setEnteredRaffle=_useState6[1];var contracts=useContractLoader(networkProvider);var updateStatus=function updateStatus(){if(contracts){contracts.CityDaoParcel.isWhitelisting().then(setWhitelistingEnabled);userAddress&&contracts.CityDaoParcel.enteredRaffle(userAddress).then(setEnteredRaffle);}};useEffect(function(){updateStatus();},[contracts,networkProvider,userAddress]);var loadWeb3Modal=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var provider;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return web3Modal.connect();case 3:provider=_context.sent;setInjectedProvider(new ethers.providers.Web3Provider(provider));provider.on(\"chainChanged\",function(chainId){DEBUG&&console.log(\"chain changed to \".concat(chainId,\"! updating providers\"));setInjectedProvider(new ethers.providers.Web3Provider(provider));});provider.on(\"accountsChanged\",function(){DEBUG&&console.log(\"account changed!\");setInjectedProvider(new ethers.providers.Web3Provider(provider));});// Subscribe to session disconnection\nprovider.on(\"disconnect\",function(code,reason){DEBUG&&console.log(code,reason);logoutOfWeb3Modal(web3Modal);});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);toast.error(\"Error connecting to a wallet\");case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);})),[setInjectedProvider,DEBUG]);return/*#__PURE__*/React.createElement(\"div\",{className:\"flex flex-col flex-grow min-w-0 items-center justify-center gap-8\"},/*#__PURE__*/React.createElement(\"img\",{src:\"/logo512.png\",alt:\"logo\",className:\"w-64\"}),whitelistingEnabled?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"primary-font text-xl\"},\"CityDAO Parcel 0 Drop\"),/*#__PURE__*/React.createElement(\"div\",{className:\"flex flex-row gap-8\"},/*#__PURE__*/React.createElement(ConnectWalletButton,{onClick:loadWeb3Modal}),/*#__PURE__*/React.createElement(EnterRaffle,{injectedProvider:injectedProvider,inRaffle:enteredRaffle,resetStatus:updateStatus}))):/*#__PURE__*/React.createElement(\"div\",{className:\"primary-font text-xl\"},\"Whitelisting has ended.\"));}","map":null,"metadata":{},"sourceType":"module"}