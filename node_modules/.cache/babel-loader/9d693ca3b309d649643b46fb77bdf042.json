{"ast":null,"code":"//      Copyright (c) 2012 Mathieu Turcotte\n//      Licensed under the MIT license.\nvar util = require('util');\n\nvar precond = require('precond');\n\nvar BackoffStrategy = require('./strategy'); // Exponential backoff strategy.\n\n\nfunction ExponentialBackoffStrategy(options) {\n  BackoffStrategy.call(this, options);\n  this.backoffDelay_ = 0;\n  this.nextBackoffDelay_ = this.getInitialDelay();\n  this.factor_ = ExponentialBackoffStrategy.DEFAULT_FACTOR;\n\n  if (options && options.factor !== undefined) {\n    precond.checkArgument(options.factor > 1, 'Exponential factor should be greater than 1 but got %s.', options.factor);\n    this.factor_ = options.factor;\n  }\n}\n\nutil.inherits(ExponentialBackoffStrategy, BackoffStrategy); // Default multiplication factor used to compute the next backoff delay from\n// the current one. The value can be overridden by passing a custom factor as\n// part of the options.\n\nExponentialBackoffStrategy.DEFAULT_FACTOR = 2;\n\nExponentialBackoffStrategy.prototype.next_ = function () {\n  this.backoffDelay_ = Math.min(this.nextBackoffDelay_, this.getMaxDelay());\n  this.nextBackoffDelay_ = this.backoffDelay_ * this.factor_;\n  return this.backoffDelay_;\n};\n\nExponentialBackoffStrategy.prototype.reset_ = function () {\n  this.backoffDelay_ = 0;\n  this.nextBackoffDelay_ = this.getInitialDelay();\n};\n\nmodule.exports = ExponentialBackoffStrategy;","map":null,"metadata":{},"sourceType":"script"}